version: '3.8'

services:
  sysmap:
    build: .
    image: sysmap:latest
    container_name: sysmap
    volumes:
      - ./output:/output
      - ./.sysmap.yaml:/app/.sysmap.yaml:ro  # Optional config file
    command: scan --format html --output /output/system_inventory.html
    environment:
      - SYSMAP_OUTPUT_DIR=/output

  sysmap-json:
    build: .
    image: sysmap:latest
    container_name: sysmap-json
    volumes:
      - ./output:/output
    command: scan --format json --output /output/system_inventory.json

  sysmap-watch:
    build: .
    image: sysmap:latest
    container_name: sysmap-watch
    volumes:
      - ./output:/output
    command: watch --interval 300  # Check every 5 minutes
    restart: unless-stopped
